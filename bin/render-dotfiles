#!/usr/bin/env bash
#
# render-dotfiles - Render dotfiles templates with bombadil
#
# Uses bombadil to link and render dotfiles for the current hostname.
# Only sends notification on failure (critical errors).
#
# Dependencies: bombadil, notify-send
# Side effects:
#   - Creates/updates symlinks for dotfiles
#   - May overwrite existing files based on bombadil configuration

HOSTNAME="$(cat /etc/hostname)"
MESSAGE="$(bombadil link -p "$HOSTNAME" 2>&1)"

case $? in
  0)
    ;;
  *)
    notify-send -u "critical" bombadil "$MESSAGE"
    ;;
esac
